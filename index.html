<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Infografía Interactiva: Espacios de Conservación</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #00a896;
      --primary-light: #02c39a;
      --primary-dark: #028090;
      --secondary: #05668d;
      --secondary-light: #028090;
      --accent: #f0a202;
      --accent-light: #f1c453;
      --warning: #f25f5c;
      --dark: #2b2d42;
      --dark-light: #4a4e69;
      --light: #f8f9fa;
      --gray: #8d99ae;
      --gray-light: #edf2f4;
      --white: #ffffff;
      --black: #1a1a1a;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
      --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
      --shadow-xl: 0 20px 40px rgba(0,0,0,0.15);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--light);
      color: var(--dark);
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Scroll personalizado */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: var(--gray-light);
    }
    ::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: var(--radius-full);
    }
    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary-dark);
    }

    /* Animaciones */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.8; }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    @keyframes neonGlow {
      0%, 100% { text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #00f7ff, 0 0 20px #00f7ff; }
      50% { text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #00f7ff, 0 0 40px #00f7ff; }
    }

    @keyframes pulseBrightness {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.5); }
    }

    /* Componentes reutilizables */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 20px;
      border-radius: var(--radius-md);
      font-weight: 600;
      text-decoration: none;
      transition: var(--transition);
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      gap: 8px;
    }

    .btn-primary {
      background: var(--primary);
      color: var(--white);
      box-shadow: var(--shadow-sm);
    }

    .btn-primary:hover {
      background: var(--primary-light);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .btn-secondary {
      background: var(--gray-light);
      color: var(--dark);
      border: 1px solid var(--gray);
    }

    .btn-secondary:hover {
      background: var(--gray);
      color: var(--white);
    }

    .btn-accent {
      background: var(--accent);
      color: var(--white);
    }

    .btn-accent:hover {
      background: var(--accent-light);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 12px;
      border-radius: var(--radius-full);
      font-size: 0.8rem;
      font-weight: 600;
      gap: 6px;
    }

    .badge-primary {
      background: var(--primary-light);
      color: var(--white);
    }

    .badge-secondary {
      background: var(--secondary-light);
      color: var(--white);
    }

    .badge-accent {
      background: var(--accent-light);
      color: var(--dark);
    }

    .container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header mejorado */
    header {
      background: linear-gradient(135deg, var(--primary-dark), var(--primary));
      padding: 15px 0;
      box-shadow: var(--shadow-lg);
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 1000;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 1.3rem;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--white);
      text-decoration: none;
    }

    .logo img {
      height: 30px;
      width: auto;
    }

    .header-buttons {
      display: flex;
      gap: 10px;
    }

    /* Main content */
    .main-content {
      margin-top: 90px;
      padding: 20px 0;
      min-height: calc(100vh - 90px);
    }

    /* Infographic container */
    .infographic-container {
      position: relative;
      width: 100%;
      height: 80vh;
      min-height: 600px;
      background-color: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
      margin-bottom: 30px;
    }

    /* Video container */
    .video-container {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    #infographic-video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background-color: #000;
    }

    .video-controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      background: rgba(0,0,0,0.7);
      padding: 10px 15px;
      border-radius: var(--radius-full);
      z-index: 10;
    }

    .video-controls .btn {
      font-size: 0.8rem;
      padding: 8px 12px;
    }

    /* Interactive hotspots */
    .hotspot {
      position: absolute;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: rgba(242, 162, 2, 0.3);
      border: 2px solid var(--accent);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      z-index: 5;
      animation: pulse 2s infinite;
      display: none; /* Ocultar inicialmente hasta que termine el video */
    }

    .hotspot::after {
      content: '';
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: var(--accent);
      transition: var(--transition);
    }

    .hotspot:hover {
      transform: scale(1.2);
      animation: none;
    }

    .hotspot.selected {
      background-color: rgba(2, 168, 150, 0.3);
      border: 2px solid var(--primary);
      animation: float 3s ease-in-out infinite;
    }

    .hotspot.selected::after {
      background-color: var(--primary);
    }

    .hotspot-label {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--white);
      padding: 5px 12px;
      border-radius: var(--radius-full);
      font-size: 0.8rem;
      font-weight: 500;
      color: var(--dark);
      box-shadow: var(--shadow-sm);
      opacity: 0;
      transition: var(--transition);
      white-space: nowrap;
    }

    .hotspot:hover .hotspot-label {
      opacity: 1;
      top: -35px;
    }

    /* Info panel */
    .info-panel {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 350px;
      max-height: calc(100% - 40px);
      background: var(--white);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-xl);
      overflow: hidden;
      z-index: 10;
      transform: translateX(120%);
      transition: transform 0.4s ease;
    }

    .info-panel.active {
      transform: translateX(0);
    }

    .panel-header {
      background: var(--primary);
      color: var(--white);
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .panel-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.2rem;
      margin-bottom: 5px;
    }

    .panel-subtitle {
      font-size: 0.8rem;
      opacity: 0.9;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .close-panel {
      background: none;
      border: none;
      color: var(--white);
      font-size: 1.2rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .close-panel:hover {
      transform: rotate(90deg);
    }

    .panel-body {
      padding: 15px;
      max-height: calc(100vh - 200px);
      overflow-y: auto;
    }

    .panel-section {
      margin-bottom: 15px;
      padding: 10px;
      border-radius: var(--radius-sm);
      background-color: var(--gray-light);
    }

    .panel-section-title {
      font-size: 1rem;
      color: var(--primary-dark);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .panel-media {
      width: 100%;
      height: 180px;
      border-radius: var(--radius-sm);
      overflow: hidden;
      margin-bottom: 15px;
      background-color: #000;
    }

    .panel-media img, .panel-media video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .panel-list {
      padding-left: 20px;
      font-size: 0.9rem;
    }

    .panel-list li {
      margin-bottom: 8px;
    }

    /* Tools panel */
    .tools-panel {
      position: absolute;
      top: 20px;
      left: 20px;
      background: var(--white);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      padding: 10px;
      z-index: 10;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .tool-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--white);
      border: 1px solid var(--gray-light);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
    }

    .tool-btn:hover {
      background: var(--primary);
      color: var(--white);
      transform: translateY(-2px);
    }

    .tool-btn.active {
      background: var(--primary);
      color: var(--white);
    }

    /* Legend */
    .legend {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background: var(--white);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      padding: 15px;
      z-index: 10;
      max-width: 250px;
      cursor: move;
    }

    .legend-title {
      font-weight: 600;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .legend-items {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.8rem;
    }

    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .legend-toggle {
      padding: 5px 10px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--gray);
      font-size: 0.8rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .legend-toggle:hover {
      background: var(--gray-light);
    }

    .legend-toggle.active {
      background: var(--primary);
      color: var(--white);
      border-color: var(--primary);
    }

    /* Selected spaces panel */
    .selected-panel {
      position: absolute;
      bottom: 80px;
      right: 20px;
      background: var(--white);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      padding: 15px;
      z-index: 10;
      max-width: 300px;
      transform: translateY(150%);
      transition: transform 0.3s ease;
      cursor: move;
      user-select: none;
    }

    .selected-panel.active {
      transform: translateY(0);
    }

    .selected-title {
      font-weight: 600;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .selected-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .selected-tag {
      background: var(--accent);
      color: var(--white);
      padding: 6px 12px;
      border-radius: var(--radius-full);
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: var(--transition);
      cursor: pointer;
    }

    .selected-tag:hover {
      background: var(--accent-light);
      transform: translateY(-2px);
    }

    /* Comparison panel */
    .comparison-panel {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      max-width: 800px;
      background: var(--white);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-xl);
      overflow: hidden;
      z-index: 20;
      display: none;
    }

    .comparison-panel.active {
      display: block;
    }

    .comparison-header {
      background: var(--primary);
      color: var(--white);
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .comparison-body {
      padding: 20px;
      max-height: 70vh;
      overflow-y: auto;
    }

    .comparison-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .comparison-item {
      margin-bottom: 15px;
    }

    .comparison-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--primary-dark);
    }

    /* Info banner */
    .info-banner {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 10px 20px;
      border-radius: var(--radius-md);
      z-index: 10;
      max-width: 80%;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
    }

    .info-banner:hover {
      background: rgba(0,0,0,0.9);
    }

    .info-banner-content {
      display: none;
      padding-top: 10px;
      font-size: 0.9rem;
    }

    .info-banner.active .info-banner-content {
      display: block;
    }

    /* Overlay images */
    .overlay-image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 4;
      pointer-events: none;
      opacity: 0;
      transition: var(--transition);
      object-fit: contain;
    }

    .overlay-image.active {
      opacity: 0.7;
    }

    /* Tooltip */
    .tooltip {
      position: absolute;
      background: var(--white);
      padding: 10px;
      border-radius: var(--radius-sm);
      box-shadow: var(--shadow-md);
      z-index: 15;
      max-width: 250px;
      font-size: 0.9rem;
      pointer-events: none;
      opacity: 0;
      transition: var(--transition);
    }

    .tooltip.active {
      opacity: 1;
    }

    /* Aportes tooltip */
    .benefit-tooltip {
      position: absolute;
      background: var(--white);
      padding: 15px;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      z-index: 15;
      max-width: 250px;
      font-size: 0.9rem;
      pointer-events: none;
      opacity: 0;
      transition: var(--transition);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .benefit-tooltip.active {
      opacity: 1;
    }

    .benefit-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 5px;
      border-radius: var(--radius-sm);
      background: rgba(0, 168, 150, 0.1);
    }

    .benefit-icon {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary);
    }

    /* Accordion */
    .accordion-item {
      margin-bottom: 10px;
      border: 1px solid var(--gray-light);
      border-radius: var(--radius-sm);
      overflow: hidden;
    }

    .accordion-header {
      background: var(--gray-light);
      padding: 10px 15px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .accordion-content {
      padding: 15px;
      display: none;
      background: var(--white);
    }

    .accordion-item.active .accordion-content {
      display: block;
    }

    /* Progress bars */
    .progress-container {
      margin-bottom: 15px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      font-size: 0.9rem;
    }

    .progress-bar {
      height: 10px;
      background: var(--gray-light);
      border-radius: var(--radius-full);
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      border-radius: var(--radius-full);
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
    }

    /* Conservation value */
    .conservation-value {
      position: absolute;
      top: 20px;
      left: 80px;
      background: var(--white);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      padding: 10px;
      z-index: 10;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .conservation-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
    }

    .conservation-color {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      flex-shrink: 0;
      border: 2px solid white;
      box-shadow: var(--shadow-sm);
    }

    /* Step navigation */
    .step-nav {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    .step-btn {
      padding: 8px 16px;
      border-radius: var(--radius-sm);
      background: var(--gray-light);
      border: none;
      cursor: pointer;
      transition: var(--transition);
    }

    .step-btn:hover {
      background: var(--primary);
      color: var(--white);
    }

    .step-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .step-indicator {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .step-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--gray);
    }

    .step-dot.active {
      background: var(--primary);
    }

    /* Step images */
    .step-image {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: var(--radius-sm);
      margin: 10px 0;
      cursor: pointer;
      transition: var(--transition);
    }

    .step-image:hover {
      transform: scale(1.02);
      box-shadow: var(--shadow-md);
    }

    .step-image.zoomed {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1.5);
      z-index: 1000;
      max-width: 90%;
      max-height: 90%;
      box-shadow: var(--shadow-xl);
    }

    /* Warning message */
    .warning-message {
      color: var(--warning);
      font-size: 0.9rem;
      margin-top: 5px;
      display: none;
    }

    /* Footer */
    .footer {
      background: var(--dark);
      color: var(--white);
      padding: 20px 0;
      text-align: center;
      font-size: 0.9rem;
    }

    .footer a {
      color: var(--primary-light);
      text-decoration: none;
    }

    /* Description box */
    .info-description {
      margin-bottom: 20px;
      background: linear-gradient(to right, var(--primary-light), var(--primary));
      padding: 20px;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-sm);
      color: white;
      text-align: center;
      font-size: 1rem;
    }

    .info-description p strong {
      font-weight: 600;
    }

    .info-description p .neon-text {
      animation: neonGlow 2s infinite alternate, pulseBrightness 1.5s infinite;
      font-weight: 600;
    }

    /* Objective options */
    .objective-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-top: 15px;
    }

    .objective-option {
      display: flex;
      align-items: center;
      padding: 10px;
      border: 1px solid var(--gray-light);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: var(--transition);
    }

    .objective-option:hover {
      background: var(--gray-light);
    }

    .objective-option input {
      margin-right: 10px;
    }

    .objective-content {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Characterization options */
    .characterization-options {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .characterization-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 15px;
      border: 1px solid var(--gray-light);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
    }

    .characterization-option:hover {
      background: var(--gray-light);
    }

    .characterization-option input {
      margin-bottom: 10px;
    }

    .characterization-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .option-info {
      color: var(--gray);
      cursor: help;
      font-size: 0.9rem;
      margin-top: 5px;
    }

    /* Conectividad stars */
    .connectivity-stars {
      position: absolute;
      display: flex;
      gap: 10px;
      z-index: 5;
    }

    .connectivity-star {
      width: 30px;
      height: 30px;
      background-color: var(--accent);
      clip-path: polygon(
        50% 0%,
        61% 35%,
        98% 35%,
        68% 57%,
        79% 91%,
        50% 70%,
        21% 91%,
        32% 57%,
        2% 35%,
        39% 35%
      );
      cursor: pointer;
      transition: var(--transition);
    }

    .connectivity-star:hover {
      transform: scale(1.2);
      background-color: var(--accent-light);
    }

    /* Conectividad popup */
    .connectivity-popup {
      position: absolute;
      width: 600px;
      max-width: 80%;
      max-height: 80vh;
      background: var(--white);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-xl);
      padding: 15px;
      z-index: 20;
      display: none;
      overflow-y: auto;
    }

    .connectivity-popup.active {
      display: block;
    }

    .connectivity-popup img {
      width: 100%;
      height: auto;
      border-radius: var(--radius-sm);
      margin-bottom: 10px;
      object-fit: contain;
      max-height: 400px;
    }

    .connectivity-popup-close {
      position: absolute;
      top: 5px;
      right: 5px;
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
    }

    /* Volume control */
    .volume-control {
      position: absolute;
      bottom: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 5px;
      z-index: 10;
    }

    .volume-slider {
      width: 100px;
      -webkit-appearance: none;
      height: 5px;
      background: var(--gray-light);
      border-radius: var(--radius-full);
      outline: none;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background: var(--white);
      cursor: pointer;
    }

    .volume-control:hover .volume-slider {
      opacity: 1;
    }

    /* Responsive styles */
    @media (max-width: 992px) {
      .infographic-container {
        height: 70vh;
      }
      
      .info-panel {
        width: 300px;
      }
      
      .objective-options {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .infographic-container {
        height: 60vh;
        min-height: 400px;
      }
      
      .info-panel {
        width: 90%;
        right: 5%;
        top: 10px;
      }
      
      .tools-panel {
        flex-direction: row;
        bottom: 10px;
        top: auto;
      }
      
      .legend {
        max-width: 200px;
        font-size: 0.8rem;
      }

      .characterization-options {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 576px) {
      .infographic-container {
        height: 50vh;
      }
      
      .comparison-panel {
        width: 95%;
      }
      
      .comparison-grid {
        grid-template-columns: 1fr;
      }

      .characterization-options {
        grid-template-columns: 1fr;
      }
    }

    /* Mantener proporciones de imágenes y círculos */
    .hotspot, .connectivity-star, .overlay-image {
      transform-origin: center center;
      transform-box: fill-box;
    }

    /* Estilo para el informe INTA en ventana modal */
    .inta-report-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      max-width: 900px;
      height: 80vh;
      background: white;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-xl);
      z-index: 1000;
      display: none;
      overflow: hidden;
    }

    .inta-report-modal.active {
      display: flex;
      flex-direction: column;
    }

    .inta-report-header {
      background: var(--primary);
      color: white;
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .inta-report-content {
      flex: 1;
      width: 100%;
      height: calc(100% - 60px);
      border: none;
    }

    .close-inta-report {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Header mejorado -->
  <header>
    <div class="container header-container">
      <a href="#" class="logo">
        <img src="logointa.jpg" alt="INTA">
        <span>INTA Conservación</span>
      </a>
      <div class="header-buttons">
        <button class="btn btn-primary" id="show-comparison">
          <i class="fas fa-chart-pie"></i> Comparar
        </button>
        <button class="btn btn-secondary" id="show-graphs">
          <i class="fas fa-chart-bar"></i> Gráficos
        </button>
        <button class="btn btn-accent" id="show-inta-report">
          <i class="fas fa-file-alt"></i> Informe INTA
        </button>
      </div>
    </div>
  </header>

  <!-- Main content -->
  <main class="main-content">
    <div class="container">
      <!-- Descripción breve mejorada -->
      <div class="info-description">
        <p><strong>Esta infografía muestra los diferentes espacios de conservación que pueden implementarse en establecimientos productivos para preservar la biodiversidad y mejorar la productividad.</strong><br>
        <span class="neon-text">Selecciona los espacios para conocerlos y comparar beneficios.</span></p>
      </div>
      
      <!-- Contenedor principal de la infografía -->
      <div class="infographic-container">
        <!-- Imágenes superpuestas -->
        <img src="corredor-continuo.gif" class="overlay-image" id="corredor-continuo-overlay" alt="Corredor continuo">
        <img src="corredor-trampolin.gif" class="overlay-image" id="corredor-trampolin-overlay" alt="Corredor trampolín">
        <img src="limites.gif" class="overlay-image" id="limites-overlay" alt="Límites de conservación">
        <img src="estructuras-clave.gif" class="overlay-image" id="estructuras-clave-overlay" alt="Estructuras clave">
        
        <!-- Video de la infografía -->
        <div class="video-container" id="video-container">
          <video id="infographic-video" loop autoplay muted>
            <source src="video.mp4" type="video/mp4">
            Tu navegador no soporta el video.
          </video>
          
          <!-- Controles del video -->
          <div class="video-controls">
            <button class="btn btn-sm btn-primary" id="play-pause-btn" title="Reproducir/Pausar introducción">
              <i class="fas fa-play"></i> Intro
            </button>
            <button class="btn btn-sm btn-secondary" id="reset-video-btn">
              <i class="fas fa-sync-alt"></i> Reiniciar
            </button>
            <button class="btn btn-sm btn-accent" id="skip-to-end-btn">
              <i class="fas fa-fast-forward"></i> Infografía
            </button>
          </div>
          
          <!-- Control de volumen -->
          <div class="volume-control">
            <i class="fas fa-volume-up"></i>
            <input type="range" class="volume-slider" id="volume-slider" min="0" max="1" step="0.1" value="1">
          </div>
          
          <!-- Puntos interactivos (hotspots) -->
          <div class="hotspot" style="top:25%;left:22%;" data-id="parque">
            <span class="hotspot-label">Parque</span>
          </div>
          <div class="hotspot" style="top:28%;left:15%;" data-id="refugio">
            <span class="hotspot-label">Refugio</span>
          </div>
          <div class="hotspot" style="top:82%;left:15%;" data-id="bordes">
            <span class="hotspot-label">Bordes</span>
          </div>
          <div class="hotspot" style="top:37%;left:68%;" data-id="franja">
            <span class="hotspot-label">Franja</span>
          </div>
          <div class="hotspot" style="top:65%;left:40%;" data-id="camino">
            <span class="hotspot-label">Camino</span>
          </div>
          <div class="hotspot" style="top:30%;left:86%;" data-id="vias-ferreas">
            <span class="hotspot-label">Vías férreas</span>
          </div>
          <div class="hotspot" style="top:24%;left:42%;" data-id="cortinas">
            <span class="hotspot-label">Cortinas</span>
          </div>
          <div class="hotspot" style="top:40%;left:60%;" data-id="cercos">
            <span class="hotspot-label">Cercos</span>
          </div>
          <div class="hotspot" style="top:30%;left:70%;" data-id="parche-natural">
            <span class="hotspot-label">Parche natural</span>
          </div>
          <div class="hotspot" style="top:18%;left:75%;" data-id="area-natural">
            <span class="hotspot-label">Área natural</span>
          </div>
          <div class="hotspot" style="top:40%;left:85%;" data-id="riberenos">
            <span class="hotspot-label">Ribereños</span>
          </div>
          <div class="hotspot" style="top:20%;left:65%;" data-id="bosque-nativo">
            <span class="hotspot-label">Bosque nativo</span>
          </div>
          
          <!-- Estrellas de conectividad -->
          <div class="connectivity-stars" style="top:15%;left:30%;">
            <div class="connectivity-star" data-id="1"></div>
          </div>
          <div class="connectivity-stars" style="top:45%;left:25%;">
            <div class="connectivity-star" data-id="2"></div>
          </div>
          <div class="connectivity-stars" style="top:75%;left:35%;">
            <div class="connectivity-star" data-id="3"></div>
          </div>
          <div class="connectivity-stars" style="top:55%;left:65%;">
            <div class="connectivity-star" data-id="4"></div>
          </div>
          <div class="connectivity-stars" style="top:25%;left:80%;">
            <div class="connectivity-star" data-id="5"></div>
          </div>
          
          <!-- Popups de conectividad -->
          <div class="connectivity-popup" id="connectivity-popup-1">
            <button class="connectivity-popup-close">&times;</button>
            <h4>Conectividad 1 - Corredor Principal</h4>
            <img src="conectividad1.jpg" alt="Mapa de conectividad 1">
            <p>Este corredor principal conecta las áreas naturales más grandes del paisaje. Según el informe INTA, los corredores principales deben tener al menos 30 metros de ancho para permitir el movimiento seguro de especies.</p>
            <p><strong>Recomendaciones:</strong> Mantener la vegetación nativa, evitar fragmentaciones y controlar especies exóticas invasoras.</p>
          </div>
          <div class="connectivity-popup" id="connectivity-popup-2">
            <button class="connectivity-popup-close">&times;</button>
            <h4>Conectividad 2 - Zona de Transición</h4>
            <img src="conectividad2.jpg" alt="Mapa de conectividad 2">
            <p>Área de transición entre espacios productivos y naturales. El informe INTA destaca que estas zonas son clave para la polinización y control biológico de plagas.</p>
            <p><strong>Recomendaciones:</strong> Enriquecer con especies nativas melíferas y mantener una estructura vegetal estratificada.</p>
          </div>
          <div class="connectivity-popup" id="connectivity-popup-3">
            <button class="connectivity-popup-close">&times;</button>
            <h4>Conectividad 3 - Corredor Ribereño</h4>
            <img src="conectividad3.jpg" alt="Mapa de conectividad 3">
            <p>Corredor lineal asociado a cursos de agua. Según el informe, estos corredores son esenciales para especies acuáticas y terrestres, mejorando la calidad del agua.</p>
            <p><strong>Recomendaciones:</strong> Proteger la vegetación ribereña y mantener un buffer de al menos 15 metros.</p>
          </div>
          <div class="connectivity-popup" id="connectivity-popup-4">
            <button class="connectivity-popup-close">&times;</button>
            <h4>Conectividad 4 - Franja Forestal</h4>
            <img src="conectividad4.jpg" alt="Mapa de conectividad 4">
            <p>Franja que conecta fragmentos de bosque nativo. El informe INTA recomienda estas estructuras para especies con baja capacidad de dispersión.</p>
            <p><strong>Recomendaciones:</strong> Ampliar el ancho donde sea posible y conectar con otros corredores.</p>
          </div>
          <div class="connectivity-popup" id="connectivity-popup-5">
            <button class="connectivity-popup-close">&times;</button>
            <h4>Conectividad 5 - Área Núcleo</h4>
            <img src="conectividad5.jpg" alt="Mapa de conectividad 5">
            <p>Área núcleo con alta biodiversidad. Según el informe, estas áreas son fundamentales para mantener poblaciones viables de especies.</p>
            <p><strong>Recomendaciones:</strong> Proteger de perturbaciones y conectar con otros espacios mediante corredores.</p>
          </div>
          
          <!-- Tooltip para información rápida -->
          <div class="tooltip" id="hotspot-tooltip"></div>
          
          <!-- Tooltip para beneficios -->
          <div class="benefit-tooltip" id="benefit-tooltip"></div>
        </div>
        
        <!-- Panel de herramientas -->
        <div class="tools-panel">
          <button class="tool-btn" id="select-tool" title="Seleccionar espacios">
            <i class="fas fa-mouse-pointer"></i>
          </button>
          <button class="tool-btn" id="info-tool" title="Información detallada">
            <i class="fas fa-info-circle"></i>
          </button>
          <button class="tool-btn" id="conservation-tool" title="Valor de conservación">
            <i class="fas fa-tree"></i>
          </button>
          <button class="tool-btn" id="benefits-tool" title="Aportes">
            <i class="fas fa-star"></i>
          </button>
          <button class="tool-btn" id="connectivity-tool" title="Conectividad">
            <i class="fas fa-project-diagram"></i>
          </button>
        </div>
        
        <!-- Valor de conservación -->
        <div class="conservation-value" id="conservation-value" style="display: none;">
          <h4 class="legend-title"><i class="fas fa-tree"></i> Valor para biodiversidad</h4>
          <div class="conservation-item">
            <div class="conservation-color" style="background: #f25f5c;"></div>
            <span>Prioritario (alto)</span>
          </div>
          <div class="conservation-item">
            <div class="conservation-color" style="background: #f0a202;"></div>
            <span>Importante (medio)</span>
          </div>
          <div class="conservation-item">
            <div class="conservation-color" style="background: #05668d;"></div>
            <span>Útil (bajo)</span>
          </div>
        </div>
        
        <!-- Leyenda mejorada -->
        <div class="legend" id="legend">
          <h4 class="legend-title"><i class="fas fa-map"></i> Leyenda</h4>
          <div class="legend-items">
            <div class="legend-item">
              <div class="legend-color" style="background: var(--accent);"></div>
              <span>Espacio de conservación</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: var(--primary);"></div>
              <span>Seleccionado</span>
            </div>
          </div>
          
          <h4 class="legend-title" style="margin-top: 10px;"><i class="fas fa-layer-group"></i> Capas</h4>
          <button class="legend-toggle" id="toggle-corredor-continuo">
            <div class="legend-color" style="background: #8a2be2;"></div>
            <span>Corredor continuo</span>
          </button>
          <button class="legend-toggle" id="toggle-corredor-trampolin">
            <div class="legend-color" style="background: #4b0082;"></div>
            <span>Corredor trampolín</span>
          </button>
          <button class="legend-toggle" id="toggle-limites">
            <div class="legend-color" style="background: #ff4500;"></div>
            <span>Límites</span>
          </button>
          <button class="legend-toggle" id="toggle-estructuras-clave">
            <div class="legend-color" style="background: #228b22;"></div>
            <span>Estructuras clave</span>
          </button>
        </div>
        
        <!-- Panel de espacios seleccionados -->
        <div class="selected-panel" id="selected-panel">
          <h4 class="selected-title"><i class="fas fa-check-circle"></i> Espacios seleccionados</h4>
          <div class="selected-list" id="selected-list"></div>
        </div>
        
        <!-- Panel de información detallada -->
        <div class="info-panel" id="info-panel">
          <div class="panel-header">
            <div>
              <h3 class="panel-title" id="panel-title"></h3>
              <div class="panel-subtitle" id="panel-subtitle">
                <i class="fas fa-tag"></i> <span id="panel-category"></span>
              </div>
            </div>
            <button class="close-panel" id="close-panel">&times;</button>
          </div>
          <div class="panel-body">
            <div class="panel-media" id="panel-media">
              <video id="panel-video" width="100%" autoplay muted loop>
                Tu navegador no soporta el elemento de video.
              </video>
            </div>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-align-left"></i> Descripción
              </h4>
              <p id="panel-text"></p>
            </div>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-list-ul"></i> Características
              </h4>
              <p id="panel-characteristics"></p>
            </div>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-tractor"></i> Beneficios para la producción
              </h4>
              <ul class="panel-list" id="panel-benefits-production"></ul>
            </div>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-leaf"></i> Beneficios para la biodiversidad
              </h4>
              <ul class="panel-list" id="panel-benefits-nature"></ul>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Panel de comparación mejorado -->
      <div class="comparison-panel" id="comparison-panel">
        <div class="comparison-header">
          <h3 class="panel-title"><i class="fas fa-chart-pie"></i> Comparación de espacios</h3>
          <button class="close-panel" id="close-comparison">&times;</button>
        </div>
        <div class="comparison-body">
          <div id="comparison-steps">
            <!-- Paso 1: Selección de espacios -->
            <div class="step" id="step-1" style="display: block;">
              <h3>Paso 1: Espacios seleccionados</h3>
              <p>Estos son los espacios de conservación que has seleccionado para comparar:</p>
              <img src="Paso1.jpg" class="step-image" alt="Paso 1">
              <div id="selected-spaces-list" style="margin: 15px 0;"></div>
              <div class="step-nav">
                <button class="step-btn" disabled>Anterior</button>
                <button class="step-btn" id="next-step-1">Siguiente</button>
              </div>
            </div>
            
            <!-- Paso 2: Definición de objetivos mejorado -->
            <div class="step" id="step-2" style="display: none;">
              <h3>Paso 2: Definición de objetivos</h3>
              <p>Establece qué quieres lograr con los espacios de conservación en tu campo. Selecciona los objetivos que deseas priorizar:</p>
              <img src="Paso2.jpg" class="step-image" alt="Paso 2">
              <div style="margin: 15px 0;">
                <div class="objective-options">
                  <label class="objective-option">
                    <input type="checkbox" name="objectives" value="conservacion">
                    <div class="objective-content">
                      <i class="fas fa-paw"></i>
                      <span>Conservación de especies nativas</span>
                    </div>
                  </label>
                  <label class="objective-option">
                    <input type="checkbox" name="objectives" value="polinizacion">
                    <div class="objective-content">
                      <i class="fas fa-bee"></i>
                      <span>Mejora en polinización de cultivos</span>
                    </div>
                  </label>
                  <label class="objective-option">
                    <input type="checkbox" name="objectives" value="control">
                    <div class="objective-content">
                      <i class="fas fa-bug"></i>
                      <span>Control biológico de plagas</span>
                    </div>
                  </label>
                  <label class="objective-option">
                    <input type="checkbox" name="objectives" value="proteccion">
                    <div class="objective-content">
                      <i class="fas fa-tint"></i>
                      <span>Protección de suelos y agua</span>
                    </div>
                  </label>
                  <label class="objective-option">
                    <input type="checkbox" name="objectives" value="conectividad">
                    <div class="objective-content">
                      <i class="fas fa-project-diagram"></i>
                      <span>Conectividad del paisaje</span>
                    </div>
                  </label>
                </div>
                <div class="warning-message" id="objectives-warning">
                  <i class="fas fa-exclamation-circle"></i> Debes seleccionar al menos un objetivo
                </div>
              </div>
              <div class="step-nav">
                <button class="step-btn" id="prev-step-2">Anterior</button>
                <button class="step-btn" id="next-step-2">Siguiente</button>
              </div>
            </div>
            
            <!-- Paso 3: Caracterización mejorada -->
            <div class="step" id="step-3" style="display: none;">
              <h3>Paso 3: Caracterización (Línea de base)</h3>
              <p>Completa las características de cada espacio seleccionado según el informe INTA:</p>
              <img src="Paso3.jpg" class="step-image" alt="Paso 3">
              
              <div id="characterization-forms" style="margin: 15px 0;">
                <!-- Formularios dinámicos para cada espacio seleccionado -->
                <div id="characterization-spaces"></div>
              </div>
              
              <div class="step-nav">
                <button class="step-btn" id="prev-step-3">Anterior</button>
                <button class="step-btn" id="next-step-3">Siguiente</button>
              </div>
            </div>
            
            <!-- Paso 4: Plan de gestión -->
            <div class="step" id="step-4" style="display: none;">
              <h3>Paso 4: Plan de gestión</h3>
              <p>Desarrolla un plan concreto para implementar los espacios de conservación:</p>
              <img src="Paso4.jpg" class="step-image" alt="Paso 4">
              <ul>
                <li>Define acciones específicas (restauración, manejo, señalización)</li>
                <li>Establece cronograma y recursos necesarios</li>
                <li>Analiza costo/beneficio de las acciones</li>
                <li>Comunica el plan a empleados y vecinos</li>
                <li>Identifica prácticas en áreas adyacentes para minimizar impacto</li>
              </ul>
              <div class="step-nav">
                <button class="step-btn" id="prev-step-4">Anterior</button>
                <button class="step-btn" id="next-step-4">Siguiente</button>
              </div>
            </div>
            
            <!-- Paso 5: Monitoreo -->
            <div class="step" id="step-5" style="display: none;">
              <h3>Paso 5: Monitoreo</h3>
              <p>Realiza seguimiento del plan de gestión:</p>
              <img src="Paso5.jpg" class="step-image" alt="Paso 5">
              <ul>
                <li>Evalúa las especies y ambientes en relación con la línea de base</li>
                <li>Mide la efectividad de las acciones implementadas</li>
                <li>Realiza ajustes y adaptaciones según resultados</li>
                <li>Documenta los cambios y aprendizajes</li>
              </ul>
              <div class="step-nav">
                <button class="step-btn" id="prev-step-5">Anterior</button>
                <button class="step-btn" id="next-step-5">Siguiente</button>
              </div>
            </div>
            
            <!-- Paso 6: Participación social -->
            <div class="step" id="step-6" style="display: none;">
              <h3>Paso 6: Participación social</h3>
              <p>Involucra a otros actores en el proceso:</p>
              <img src="Paso6.jpg" class="step-image" alt="Paso 6">
              <ul>
                <li>Promueve la participación de productores vecinos</li>
                <li>Establece alianzas con la comunidad, academia o gobierno</li>
                <li>Evalúa inclusión en legislaciones de áreas de conservación</li>
                <li>Identifica nuevas áreas con potencial para conectar</li>
              </ul>
              <div class="step-nav">
                <button class="step-btn" id="prev-step-6">Anterior</button>
                <button class="btn btn-primary" id="finish-process">Finalizar Proceso</button>
              </div>
            </div>
          </div>
          
          <!-- Informe Final mejorado -->
          <div id="final-report" style="margin-top: 30px; display: none;">
            <h3 class="panel-title"><i class="fas fa-file-alt"></i> Informe Final</h3>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-check-circle"></i> Resumen de espacios seleccionados
              </h4>
              <div id="selected-spaces-summary"></div>
            </div>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-exclamation-triangle"></i> Recomendaciones según informe INTA
              </h4>
              <p>Basado en los espacios seleccionados y el informe técnico del INTA, estas son las recomendaciones clave:</p>
              
              <div id="inta-recommendations">
                <!-- Las recomendaciones se generarán dinámicamente basadas en la selección -->
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Conectividad del paisaje</span>
                  <span>${selectedSpaces.length > 2 ? 'Buena' : 'Mejorable'}</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: ${selectedSpaces.length > 2 ? '70' : '40'}%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
                </div>
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Diversidad de hábitats</span>
                  <span>${selectedSpaces.length > 3 ? 'Alta' : 'Moderada'}</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: ${selectedSpaces.length > 3 ? '80' : '60'}%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
                </div>
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Potencial de conservación</span>
                  <span>${selectedSpaces.some(s => ['parque', 'area-natural', 'bosque-nativo'].includes(s)) ? 'Alto' : 'Moderado'}</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: ${selectedSpaces.some(s => ['parque', 'area-natural', 'bosque-nativo'].includes(s)) ? '85' : '65'}%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
                </div>
              </div>
              
              <p>Según el informe INTA, la combinación de diferentes tipos de espacios aumenta significativamente los beneficios ecológicos y productivos.</p>
            </div>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-project-diagram"></i> Conectividad y corredores biológicos
              </h4>
              <p>Análisis basado en el informe técnico del INTA:</p>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Ancho efectivo de corredores</span>
                  <span>${selectedSpaces.some(s => ['franja', 'bordes', 'camino'].includes(s)) ? 'Adecuado' : 'Insuficiente'}</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: ${selectedSpaces.some(s => ['franja', 'bordes', 'camino'].includes(s)) ? '75' : '30'}%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
                </div>
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Distancia entre nodos</span>
                  <span>${selectedSpaces.length > 2 ? 'Óptima' : 'Puede mejorarse'}</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: ${selectedSpaces.length > 2 ? '80' : '50'}%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
                </div>
              </div>
              
              <p>El informe INTA recomienda mantener corredores con al menos 30 metros de ancho y distancias máximas de 300m entre espacios para la mayoría de las especies.</p>
            </div>
            
            <div class="panel-section">
              <h4 class="panel-section-title">
                <i class="fas fa-calendar-alt"></i> Cronograma sugerido
              </h4>
              <p>Recomendaciones temporales basadas en el informe INTA:</p>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Invierno (Planificación)</span>
                  <span>100%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 100%; background: linear-gradient(90deg, #05668d, #028090);"></div>
                </div>
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Primavera (Implementación)</span>
                  <span>25%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 25%; background: linear-gradient(90deg, #05668d, #028090);"></div>
                </div>
              </div>
              
              <div class="progress-container">
                <div class="progress-label">
                  <span>Verano (Monitoreo)</span>
                  <span>10%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 10%; background: linear-gradient(90deg, #05668d, #028090);"></div>
                </div>
              </div>
              
              <p>Según el informe INTA, la primavera es el mejor momento para establecer nuevos espacios de conservación.</p>
            </div>
            
            <button class="btn btn-primary" id="generate-report-btn" style="margin-top: 20px;">
              <i class="fas fa-download"></i> Descargar Informe Completo
            </button>
          </div>
        </div>
      </div>
      
      <!-- Panel de gráficos -->
      <div class="comparison-panel" id="graphs-panel">
        <div class="comparison-header">
          <h3 class="panel-title"><i class="fas fa-chart-bar"></i> Análisis Gráfico</h3>
          <button class="close-panel" id="close-graphs">&times;</button>
        </div>
        <div class="comparison-body">
          <div id="graphs-content">
            <div class="panel-section">
              <p id="graphs-message">Para ver los gráficos, primero debes completar el proceso de comparación de espacios.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal para informe INTA -->
      <div class="inta-report-modal" id="inta-report-modal">
        <div class="inta-report-header">
          <h3>Informe INTA - Espacios de Conservación</h3>
          <button class="close-inta-report" id="close-inta-report">&times;</button>
        </div>
        <iframe class="inta-report-content" src="https://repositorio.inta.gob.ar/bitstream/handle/20.500.12123/17068/INTA_CRBsAsNorte_EEADeltadelParana_Fracassi_N_Espacios_de_Conservacion_de_Agroecosistemas%20.pdf?sequence=1&isAllowed=y"></iframe>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>Plataforma desarrollada por INTA - Proyecto Espacios de Conservación en Agroecosistemas</p>
      <p>Basado en el informe técnico: <a href="https://repositorio.inta.gob.ar/bitstream/handle/20.500.12123/17068/INTA_CRBsAsNorte_EEADeltadelParana_Fracassi_N_Espacios_de_Conservacion_de_Agroecosistemas%20.pdf?sequence=1&isAllowed=y" target="_blank">Espacios de Conservación de Agroecosistemas</a></p>
      <p>© 2023 INTA - Todos los derechos reservados</p>
    </div>
  </footer>

  <script>
    // Datos para los espacios de conservación
    const dataMap = {
      parque: {
        titulo: "Parques o áreas multifunción",
        categoria: "Espacio Seminatural | Areal",
        texto: "Áreas pequeñas (0,25-2 ha) integradas en el establecimiento con vegetación natural o cultivada que cumplen múltiples funciones ecológicas y productivas.",
        caracteristicas: "Forma poligonal. Ubicación: casco, vivero, monte frutal, huerta. Combinación de especies vegetales nativas o exóticas que pueden albergar fauna nativa con manejo especial.",
        beneficiosProduccion: [
          "Provisión de flora de interés apícola (polen, néctar, propóleos)",
          "Refugio para insectos benéficos (depredadores de plagas, parasitoides, polinizadores)",
          "Bienestar animal por provisión de sombra natural",
          "Reserva de plantas y semillas de flora nativa de interés forrajero, medicinal, alimenticio"
        ],
        beneficiosNaturaleza: [
          "Provisión de hábitat para insectos, aves y mamíferos pequeños",
          "Reservorio de flora nativa, fuente de diversidad genética",
          "Posaderos para aves que colaboran en dispersión de semillas",
          "Provisión de recursos florales para polinizadores"
        ],
        video: "parque.mp4",
        image: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Área: 0.25-2 ha | Forma: Poligonal | Especies: Nativas/Exóticas | Manejo: Especial",
        conservacion: "alto",
        aportes: {
          "1A": "Aumenta la diversidad de polinizadores",
          "1B": "Mejora la polinización de cultivos",
          "2A": "Provee hábitat para depredadores naturales de plagas",
          "3B": "Reduce la erosión del suelo",
          "4C": "Mejora la infiltración de agua"
        }
      },
      refugio: {
        titulo: "Parche Seminatural (Refugio)",
        categoria: "Espacio Seminatural | Areal",
        texto: "Área pequeña (<1 ha) dentro del establecimiento con vegetación espontánea nativa o exótica que proporciona refugio a la fauna benéfica.",
        caracteristicas: "Forma poligonal. Ubicación: taperas, aguadas, tajamares, tanques australianos. Vegetación espontánea que se mantiene sin intervención o con manejo mínimo.",
        beneficiosProduccion: [
          "Distracción de fauna silvestre sobre cultivos principales",
          "Provisión de refugios para insectos benéficos",
          "Reserva de vegetación para forrajeo en épocas críticas",
          "Control natural de plagas por presencia de depredadores"
        ],
        beneficiosNaturaleza: [
          "Provisión de ambientes de resguardo temporal para fauna",
          "Hábitat para insectos y pequeños vertebrados",
          "Conservación de vegetación espontánea",
          "Sitios de reproducción para algunas especies"
        ],
        video: "refugio.mp4",
        image: "https://images.unsplash.com/photo-1476231682828-37e571bc172f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Área: <1 ha | Forma: Poligonal | Especies: Espontáneas | Manejo: Mínimo",
        conservacion: "medio",
        aportes: {
          "1C": "Provee refugio para fauna auxiliar",
          "2B": "Reduce la presión de herbívoros sobre cultivos",
          "3A": "Mantiene la humedad del suelo",
          "4A": "Preserva especies vegetales nativas"
        }
      },
      bordes: {
        titulo: "Bordes de cultivo o alambrado",
        categoria: "Espacio Seminatural | Corredor Lineal",
        texto: "Franja de vegetación nativa o espontánea en bordes de cultivos o alambrados que generan hábitat y conectividad para la biodiversidad.",
        caracteristicas: "Forma lineal. Ancho: 3-6 m. Ubicación: bordes perimetrales o callejones centrales entre lotes. Pueden sembrarse con especies entomófilas nativas y no nativas.",
        beneficiosProduccion: [
          "Separación de ambientes productivos",
          "Presencia de especies entomófilas que atraen polinizadores",
          "Control de erosión por reducción de escorrentía",
          "Filtrado de sedimentos y contaminantes de campos adyacentes"
        ],
        beneficiosNaturaleza: [
          "Conectividad entre hábitats fragmentados",
          "Provisión de recursos florales para polinizadores",
          "Hábitat lineal para insectos y pequeños vertebrados",
          "Corredor para movimiento de especies entre áreas"
        ],
        video: "bordes.mp4",
        image: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Ancho: 3-6 m | Forma: Lineal | Especies: Entomófilas | Manejo: Moderado",
        conservacion: "medio",
        aportes: {
          "1B": "Incrementa la polinización cruzada",
          "2C": "Provee corredores para movimiento de fauna",
          "3C": "Reduce la deriva de agroquímicos",
          "4B": "Filtra nutrientes en escorrentías"
        }
      },
      franja: {
        titulo: "Franja vegetada o natural",
        categoria: "Espacio Seminatural | Corredor Lineal",
        texto: "Franjas con vegetación espontánea o implantada en lotes de cultivos que aportan biodiversidad y servicios ecosistémicos.",
        caracteristicas: "Forma lineal. Ancho: 6-12 m, longitud: 200-400 m. Ubicación: límites o interior de lotes, asociadas a zonas de drenaje. Pueden tener vegetación espontánea o implantada con especies forrajeras y melíferas.",
        beneficiosProduccion: [
          "Reducción del tamaño de lotes para manejo más eficiente",
          "Atracción de polinizadores que incrementan rendimientos",
          "Control natural de plagas por presencia de depredadores",
          "Protección contra vientos y reducción de erosión"
        ],
        beneficiosNaturaleza: [
          "Conectividad entre espacios de conservación",
          "Provisión de recursos florales para polinizadores",
          "Hábitat para insectos benéficos",
          "Disminución de la fragmentación del paisaje"
        ],
        video: "franja.mp4",
        image: "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Ancho: 6-12 m | Longitud: 200-400 m | Especies: Forrajeras/Melíferas | Manejo: Regular",
        conservacion: "medio",
        aportes: {
          "1D": "Aumenta la diversidad de artrópodos benéficos",
          "2D": "Reduce la incidencia de plagas",
          "3D": "Mejora la estructura del suelo",
          "4D": "Incrementa la infiltración de agua"
        }
      },
      camino: {
        titulo: "Bordes de caminos rurales",
        categoria: "Espacio Seminatural | Corredor Lineal",
        texto: "Veredas o préstamos de caminos con vegetación espontánea que pueden formar pequeños humedales temporarios y funcionan como corredores lineales clave.",
        caracteristicas: "Forma lineal. Ancho variable: 2-40 m. Ubicación: espacio entre cuneta y alambrados. Pueden enriquecerse con especies nativas acordes al ambiente. Según relieve, pueden formar humedales temporarios con vegetación ribereña.",
        beneficiosProduccion: [
          "Protección de la infraestructura vial",
          "Control de erosión por desaceleración del agua",
          "Filtrado de aguas de escorrentía",
          "Posible aprovechamiento de flora melífera"
        ],
        beneficiosNaturaleza: [
          "Conectividad lineal a lo largo de grandes distancias",
          "Formación de microhumedales temporarios",
          "Refugio para especies asociadas a ambientes acuáticos",
          "Corredor para dispersión de flora y fauna"
        ],
        video: "camino.mp4",
        image: "https://images.unsplash.com/photo-1521737604893-d14cc237f11d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Ancho: 2-40 m | Forma: Lineal | Especies: Ribereñas | Manejo: Adaptativo",
        conservacion: "bajo",
        aportes: {
          "1E": "Conecta fragmentos de hábitat",
          "2E": "Provee recursos para fauna en movimiento",
          "3E": "Retiene sedimentos y contaminantes",
          "4E": "Regula flujos de agua"
        }
      },
      "vias-ferreas": {
        titulo: "Terraplén o vías férreas",
        categoria: "Espacio Seminatural | Corredor Lineal",
        texto: "Franja vegetada a lo largo de las vías del tren que funcionan como refugio para fauna y tienen potencial como pasafauna para conectar hábitats fragmentados.",
        caracteristicas: "Forma lineal. Longitud considerable, atravesando grandes trayectos. Vegetación espontánea nativa. Alcantarillas funcionan como pasafaunas y refugios (dormideros) para varias especies.",
        beneficiosProduccion: [
          "Mantenimiento de infraestructura ferroviaria",
          "Control de erosión en terraplenes",
          "Protección contra vientos",
          "Valor paisajístico"
        ],
        beneficiosNaturaleza: [
          "Conectividad a escala regional",
          "Reservorios de vegetación nativa en paisajes agrícolas",
          "Pasafaunas en alcantarillas",
          "Refugio para especies en movimiento"
        ],
        video: "vias-ferreas.mp4",
        image: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Longitud: Variable | Forma: Lineal | Especies: Nativas | Manejo: Mínimo",
        conservacion: "medio",
        aportes: {
          "1F": "Conectividad a gran escala",
          "2F": "Pasos seguros para fauna",
          "3F": "Barrera contra especies invasoras",
          "4F": "Corredor climático"
        }
      },
      cortinas: {
        titulo: "Cortinas forestales",
        categoria: "Espacio Seminatural | Corredor Lineal",
        texto: "Alineaciones de árboles que actúan como conectores estructurales y protección frente al viento, con valor ecológico según su diseño y composición.",
        caracteristicas: "Forma lineal. Ubicación: en una sola hilara o franja, nativas o exóticas. En zonas de bosque nativo pueden aportar a la conectividad para algunas especies, principalmente insectos y aves.",
        beneficiosProduccion: [
          "Protección de cultivos contra vientos",
          "Reducción de la erosión eólica",
          "Sombra para animales domésticos",
          "Producción forestal secundaria"
        ],
        beneficiosNaturaleza: [
          "Conectividad estructural en paisajes agrícolas",
          "Hábitat para aves e insectos",
          "Corredor para movimiento de especies voladoras",
          "Refugio temporal para fauna en desplazamiento"
        ],
        video: "cortinas.mp4",
        image: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Forma: Lineal | Especies: Arbóreas | Función: Cortavientos | Manejo: Regular",
        conservacion: "bajo",
        aportes: {
          "1G": "Protección contra vientos",
          "2G": "Reducción de erosión eólica",
          "3G": "Sombra para ganado",
          "4G": "Producción de madera"
        }
      },
      cercos: {
        titulo: "Cercos vivos",
        categoria: "Espacio Seminatural | Corredor Lineal",
        texto: "Plantaciones lineales de arbustos o herbáceas que delimitan parcelas y aportan biodiversidad al paisaje agrícola.",
        caracteristicas: "Forma lineal. Plantaciones de especies herbáceas o arbustivas en líneas, muy cercanas entre sí. Pueden ser nativas (ej. falso guayabo) en zonas con bosque nativo, aportando conectividad para insectos y aves.",
        beneficiosProduccion: [
          "Delimitación de parcelas y potreros",
          "Protección de montes frutales y huertas",
          "Flora para apicultura",
          "Producción de frutos para consumo humano o animal"
        ],
        beneficiosNaturaleza: [
          "Conectividad lineal en escala local",
          "Recursos florales para polinizadores",
          "Hábitat para insectos benéficos",
          "Fuente de alimento para aves frugívoras"
        ],
        video: "cercos.mp4",
        image: "https://images.unsplash.com/photo-1476231682828-37e571bc172f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Forma: Lineal | Especies: Arbustivas | Función: Delimitación | Manejo: Regular",
        conservacion: "bajo",
        aportes: {
          "1H": "Delimitación natural de parcelas",
          "2H": "Fuente de néctar para polinizadores",
          "3H": "Barrera contra herbívoros",
          "4H": "Producción de frutos"
        }
      },
      "parche-natural": {
        titulo: "Parche Natural (Refugio)",
        categoria: "Espacio Natural | Areal",
        texto: "Área pequeña (<1-5 ha) de vegetación nativa (relicto del ambiente original) que persiste en la matriz productiva, pudiendo coincidir con humedales temporarios.",
        caracteristicas: "Forma poligonal. Ubicación: parte de un establecimiento donde se mantiene vegetación natural, se restaura o enriquece con plantas nativas. Puede ser sitio con rendimiento limitado por condiciones edáficas.",
        beneficiosProduccion: [
          "Conservación de suelos en áreas marginales",
          "Reserva de flora nativa de interés forrajero o medicinal",
          "Control natural de plagas por presencia de depredadores",
          "Protección de fuentes de agua"
        ],
        beneficiosNaturaleza: [
          "Conservación de vegetación nativa relictual",
          "Hábitat para especies asociadas a ambientes originales",
          "Nodos de biodiversidad en paisajes agrícolas",
          "Fuente de semillas para restauración"
        ],
        video: "parche-natural.mp4",
        image: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Área: <1-5 ha | Forma: Poligonal | Especies: Nativas | Manejo: Restauración",
        conservacion: "alto",
        aportes: {
          "1I": "Reservorio de biodiversidad nativa",
          "2I": "Fuente de semillas para restauración",
          "3I": "Control natural de plagas",
          "4I": "Protección de recursos hídricos"
        }
      },
      "area-natural": {
        titulo: "Área Natural",
        categoria: "Espacio Natural | Areal",
        texto: "Superficies mayores a 5 hectáreas que conservan el ambiente original de la ecorregión, pudiendo ser delimitadas como áreas protegidas o con manejo especial.",
        caracteristicas: "Forma poligonal. Combinación de parches de diferentes ambientes y tamaños. Se mantiene vegetación natural, se restaura y/o enriquece con plantas nativas. Ejemplos: lagunas, arroyos, bañados, mogotes, bosques o pastizales originales.",
        beneficiosProduccion: [
          "Conservación de recursos hídricos",
          "Reserva genética de especies nativas útiles",
          "Posibilidades de ecoturismo y educación ambiental",
          "Provisión de servicios ecosistémicos clave"
        ],
        beneficiosNaturaleza: [
          "Conservación de biodiversidad a escala de paisaje",
          "Hábitat para especies con mayores requerimientos",
          "Núcleos para restauración ecológica",
          "Mantenimiento de procesos ecológicos a gran escala"
        ],
        video: "area-natural.mp4",
        image: "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Área: >5 ha | Forma: Poligonal | Especies: Nativas | Manejo: Protección",
        conservacion: "alto",
        aportes: {
          "1J": "Conservación de ecosistemas completos",
          "2J": "Hábitat para especies amenazadas",
          "3J": "Regulación climática local",
          "4J": "Reserva de recursos genéticos"
        }
      },
      riberenos: {
        titulo: "Bordes ribereños",
        categoria: "Espacio Natural | Corredor Lineal",
        texto: "Franjas vegetadas junto a arroyos, ríos o cuerpos de agua que regulan escorrentía, protegen de la erosión y ofrecen hábitat acuático y terrestre.",
        caracteristicas: "Forma lineal. Ubicación: bordes de cursos o cuerpos de agua (franja ribereña). Vegetación espontánea adaptada a condiciones de humedad. Escala variable según características del curso de agua.",
        beneficiosProduccion: [
          "Protección de infraestructura contra erosión",
          "Mantenimiento de calidad de aguas para uso productivo",
          "Conservación de pesquerías",
          "Filtrado de aguas residuales y de escorrentía"
        ],
        beneficiosNaturaleza: [
          "Conservación de ambientes acuáticos y ribereños",
          "Hábitat para especies asociadas a cuerpos de agua",
          "Corredores lineales de alta diversidad biológica",
          "Regulación de ciclos hidrológicos"
        ],
        video: "riberenos.mp4",
        image: "https://images.unsplash.com/photo-1521737604893-d14cc237f11d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Forma: Lineal | Especies: Adaptadas | Función: Protección ribereña | Manejo: Adaptativo",
        conservacion: "medio",
        aportes: {
          "1K": "Protección contra erosión fluvial",
          "2K": "Filtro natural de contaminantes",
          "3K": "Hábitat para fauna acuática",
          "4K": "Regulación de caudales"
        }
      },
      "bosque-nativo": {
        titulo: "Franjas de bosque nativo",
        categoria: "Espacio Natural | Corredor Lineal",
        texto: "Remanentes lineales de bosque autóctono que mantienen la conectividad del paisaje, especialmente importantes en regiones con alta fragmentación.",
        caracteristicas: "Forma lineal. Largo promedio 1800 m, superficie promedio 8 ha, ancho promedio 100 m. Ubicación: remanentes del cambio de uso del suelo a agricultura, generalmente en bordes de propiedades o cursos de agua.",
        beneficiosProduccion: [
          "Protección de cultivos contra vientos",
          "Conservación de suelos en pendientes",
          "Producción forestal sostenible",
          "Posibilidades de turismo educativo"
        ],
        beneficiosNaturaleza: [
          "Conectividad entre fragmentos boscosos",
          "Hábitat para especies forestales",
          "Conservación de flora y fauna especializada",
          "Corredores para especies con baja movilidad"
        ],
        video: "bosque-nativo.mp4",
        image: "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
        ficha: "Longitud: 1800 m | Ancho: 100 m | Especies: Bosque nativo | Manejo: Conservación",
        conservacion: "alto",
        aportes: {
          "1L": "Conectividad estructural para fauna forestal",
          "2L": "Reservorio de especies maderables",
          "3L": "Protección de cuencas hidrográficas",
          "4L": "Secuestro de carbono"
        }
      }
    };

    // Variables de estado
    let selectedSpaces = [];
    let currentTool = 'select'; // 'select', 'info', 'conservation', 'benefits', 'connectivity'
    let videoPlaying = false;
    let video = document.getElementById('infographic-video');
    let hoverTimeout = null;
    let zoomLevel = 1;
    let isDragging = false;
    let dragStartX, dragStartY;
    let selectedPanel = document.getElementById('selected-panel');
    let legendPanel = document.getElementById('legend');
    let conservationPanel = document.getElementById('conservation-value');
    let currentStep = 1;
    let videoContainer = document.getElementById('video-container');
    let isDraggingVideo = false;
    let videoDragStartX, videoDragStartY;
    let videoOffsetX = 0, videoOffsetY = 0;
    let comparisonCompleted = false;
    let spaceCharacteristics = {}; // Almacena características de cada espacio

    // Inicializar el video para que comience automáticamente
    function initVideo() {
      video.addEventListener('loadedmetadata', function() {
        // Reproducir automáticamente al cargar (muted para autoplay en navegadores modernos)
        video.play();
      });
      
      video.addEventListener('seeked', function() {
        if (!videoPlaying) {
          video.pause();
        }
      });
      
      video.addEventListener('play', function() {
        videoPlaying = true;
        document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-pause"></i> Intro';
        hideHotspots();
      });
      
      video.addEventListener('pause', function() {
        videoPlaying = false;
        document.getElementById('play-pause-btn').innerHTML = '<i class="fas fa-play"></i> Intro';
      });
      
      video.addEventListener('ended', function() {
        // Mostrar los hotspots cuando termina el video
        showHotspots();
        // Pausar en el último fotograma sin reiniciar
        video.pause();
        video.currentTime = video.duration - 0.1;
      });

      // Control de volumen
      const volumeSlider = document.getElementById('volume-slider');
      volumeSlider.addEventListener('input', function() {
        video.volume = this.value;
      });

      // Mostrar control de volumen al pasar el mouse
      const volumeControl = document.querySelector('.volume-control');
      volumeControl.addEventListener('mouseenter', function() {
        volumeSlider.style.opacity = '1';
      });
      volumeControl.addEventListener('mouseleave', function() {
        volumeSlider.style.opacity = '0';
      });
    }

    // Mostrar los hotspots
    function showHotspots() {
      document.querySelectorAll('.hotspot').forEach(hotspot => {
        hotspot.style.display = 'flex';
      });
    }

    // Ocultar los hotspots
    function hideHotspots() {
      document.querySelectorAll('.hotspot').forEach(hotspot => {
        hotspot.style.display = 'none';
      });
    }

    // Mostrar información detallada de un espacio
    function showSpaceInfo(spaceId) {
      const data = dataMap[spaceId];
      if (!data) return;
      
      document.getElementById('panel-title').textContent = data.titulo;
      document.getElementById('panel-category').textContent = data.categoria;
      document.getElementById('panel-text').textContent = data.texto;
      document.getElementById('panel-characteristics').textContent = data.caracteristicas;
      
      // Limpiar listas
      document.getElementById('panel-benefits-production').innerHTML = '';
      document.getElementById('panel-benefits-nature').innerHTML = '';
      
      // Llenar listas de beneficios
      data.beneficiosProduccion.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        document.getElementById('panel-benefits-production').appendChild(li);
      });
      
      data.beneficiosNaturaleza.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        document.getElementById('panel-benefits-nature').appendChild(li);
      });
      
      // Configurar multimedia
      const panelMedia = document.getElementById('panel-media');
      panelMedia.innerHTML = '';
      
      if (data.video) {
        const video = document.createElement('video');
        video.id = 'panel-video';
        video.src = data.video;
        video.controls = true;
        video.autoplay = true;
        video.muted = false;
        video.loop = true;
        video.style.width = '100%';
        panelMedia.appendChild(video);
      } else if (data.image) {
        const img = document.createElement('img');
        img.src = data.image;
        img.alt = data.titulo;
        img.style.width = '100%';
        img.style.objectFit = 'cover';
        panelMedia.appendChild(img);
      }
      
      // Mostrar panel
      document.getElementById('info-panel').classList.add('active');
    }

    // Mostrar tooltip con información rápida
    function showTooltip(spaceId, x, y) {
      const data = dataMap[spaceId];
      if (!data) return;
      
      const tooltip = document.getElementById('hotspot-tooltip');
      tooltip.innerHTML = `<strong>${data.titulo}</strong><br>${data.ficha}`;
      tooltip.style.left = `${x + 20}px`;
      tooltip.style.top = `${y}px`;
      tooltip.classList.add('active');
    }

    // Mostrar tooltip de beneficios
    function showBenefitsTooltip(spaceId, x, y) {
      const data = dataMap[spaceId];
      if (!data || !data.aportes) return;
      
      const tooltip = document.getElementById('benefit-tooltip');
      tooltip.innerHTML = '';
      
      // Agregar cada beneficio con su ícono
      for (const [code, description] of Object.entries(data.aportes)) {
        const benefitItem = document.createElement('div');
        benefitItem.className = 'benefit-item';
        
        // Crear ícono basado en el código
        let iconClass = '';
        if (code.startsWith('1')) iconClass = 'fas fa-leaf'; // Biodiversidad
        else if (code.startsWith('2')) iconClass = 'fas fa-tractor'; // Producción
        else if (code.startsWith('3')) iconClass = 'fas fa-water'; // Suelo/Agua
        else if (code.startsWith('4')) iconClass = 'fas fa-project-diagram'; // Conectividad
        
        benefitItem.innerHTML = `
          <i class="${iconClass} benefit-icon"></i>
          <span>${description}</span>
        `;
        tooltip.appendChild(benefitItem);
      }
      
      // Posicionar el tooltip más cerca del hotspot
      const hotspot = document.querySelector(`.hotspot[data-id="${spaceId}"]`);
      if (hotspot) {
        const hotspotRect = hotspot.getBoundingClientRect();
        const containerRect = document.querySelector('.infographic-container').getBoundingClientRect();
        
        // Calcular posición para que no salga del contenedor
        let left = hotspotRect.right - containerRect.left + 10;
        let top = hotspotRect.top - containerRect.top;
        
        // Ajustar si se sale por la derecha
        if (left + 250 > containerRect.width) {
          left = hotspotRect.left - containerRect.left - 250 - 10;
        }
        
        // Ajustar si se sale por abajo
        if (top + tooltip.offsetHeight > containerRect.height) {
          top = containerRect.height - tooltip.offsetHeight - 10;
        }
        
        tooltip.style.left = `${left}px`;
        tooltip.style.top = `${top}px`;
      } else {
        tooltip.style.left = `${x + 20}px`;
        tooltip.style.top = `${y}px`;
      }
      
      tooltip.classList.add('active');
    }

    // Ocultar tooltip
    function hideTooltip() {
      document.getElementById('hotspot-tooltip').classList.remove('active');
      document.getElementById('benefit-tooltip').classList.remove('active');
    }

    // Ocultar panel de información
    function hideSpaceInfo() {
      document.getElementById('info-panel').classList.remove('active');
      const panelVideo = document.getElementById('panel-video');
      if (panelVideo) panelVideo.pause();
    }

    // Seleccionar/deseleccionar un espacio
    function toggleSpaceSelection(spaceId) {
      const index = selectedSpaces.indexOf(spaceId);
      const hotspot = document.querySelector(`.hotspot[data-id="${spaceId}"]`);
      
      if (index === -1) {
        selectedSpaces.push(spaceId);
        hotspot.classList.add('selected');
      } else {
        selectedSpaces.splice(index, 1);
        hotspot.classList.remove('selected');
      }
      
      updateSelectedSpacesList();
    }

    // Actualizar la lista de espacios seleccionados
    function updateSelectedSpacesList() {
      const selectedList = document.getElementById('selected-list');
      selectedList.innerHTML = '';
      
      if (selectedSpaces.length === 0) {
        document.getElementById('selected-panel').classList.remove('active');
        return;
      }
      
      document.getElementById('selected-panel').classList.add('active');
      
      selectedSpaces.forEach(spaceId => {
        const data = dataMap[spaceId];
        if (!data) return;
        
        const tag = document.createElement('div');
        tag.className = 'selected-tag';
        tag.innerHTML = `<i class="fas fa-map-marker-alt"></i>${data.titulo}`;
        tag.addEventListener('click', () => showSpaceInfo(spaceId));
        selectedList.appendChild(tag);
      });
    }

    // Generar comparación de espacios seleccionados
    function generateComparison() {
      if (selectedSpaces.length < 2) {
        alert('Selecciona al menos 2 espacios para comparar');
        return;
      }
      
      // Mostrar el paso 1
      currentStep = 1;
      showStep(currentStep);
      
      // Mostrar panel de comparación
      document.getElementById('comparison-panel').classList.add('active');
      document.getElementById('final-report').style.display = 'none';
      
      // Mostrar lista de espacios seleccionados en el paso 1
      const selectedList = document.getElementById('selected-spaces-list');
      selectedList.innerHTML = '';
      
      selectedSpaces.forEach(spaceId => {
        const data = dataMap[spaceId];
        if (!data) return;
        
        const item = document.createElement('div');
        item.className = 'comparison-item';
        item.innerHTML = `<strong>${data.titulo}</strong>: ${data.texto.substring(0, 100)}...`;
        selectedList.appendChild(item);
      });
    }

    // Mostrar un paso específico del proceso de comparación
    function showStep(step) {
      // Ocultar todos los pasos
      document.querySelectorAll('.step').forEach(stepEl => {
        stepEl.style.display = 'none';
      });
      
      // Mostrar el paso actual
      document.getElementById(`step-${step}`).style.display = 'block';
      
      // Si es el paso 3, generar los formularios de caracterización
      if (step === 3) {
        generateCharacterizationForms();
      }
      
      // Actualizar el indicador de pasos
      updateStepIndicator();
    }

    // Generar formularios de caracterización para cada espacio seleccionado
    function generateCharacterizationForms() {
      const container = document.getElementById('characterization-spaces');
      container.innerHTML = '';
      
      selectedSpaces.forEach(spaceId => {
        const data = dataMap[spaceId];
        if (!data) return;
        
        const spaceDiv = document.createElement('div');
        spaceDiv.className = 'panel-section';
        spaceDiv.innerHTML = `
          <h4 class="panel-section-title">
            <i class="fas fa-map-marker-alt"></i> ${data.titulo}
          </h4>
          
          <div class="panel-section">
            <h4 class="panel-section-title">
              <i class="fas fa-ruler-combined"></i> Tamaño aproximado
            </h4>
            <div class="characterization-options">
              <label class="characterization-option">
                <input type="radio" name="size-${spaceId}" value="pequeno">
                <div class="characterization-content">
                  <i class="fas fa-square" style="color: #4CAF50;"></i>
                  <span>Pequeño (<1 ha)</span>
                </div>
                <span class="option-info">Espacios menores a 1 hectárea, ideales para integración en áreas productivas intensivas</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="size-${spaceId}" value="mediano">
                <div class="characterization-content">
                  <i class="fas fa-square" style="color: #FFC107;"></i>
                  <span>Mediano (1-5 ha)</span>
                </div>
                <span class="option-info">Espacios entre 1 y 5 hectáreas, balance entre conservación y producción</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="size-${spaceId}" value="grande">
                <div class="characterization-content">
                  <i class="fas fa-square" style="color: #F44336;"></i>
                  <span>Grande (>5 ha)</span>
                </div>
                <span class="option-info">Espacios mayores a 5 hectáreas, alto valor de conservación</span>
              </label>
            </div>
          </div>
          
          <div class="panel-section">
            <h4 class="panel-section-title">
              <i class="fas fa-tree"></i> Composición de especies
            </h4>
            <div class="characterization-options">
              <label class="characterization-option">
                <input type="radio" name="composition-${spaceId}" value="nativas">
                <div class="characterization-content">
                  <i class="fas fa-leaf" style="color: #4CAF50;"></i>
                  <span>Nativas (>70%)</span>
                </div>
                <span class="option-info">Más del 70% de especies nativas, máximo beneficio para biodiversidad</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="composition-${spaceId}" value="mixtas">
                <div class="characterization-content">
                  <i class="fas fa-leaf" style="color: #FFC107;"></i>
                  <span>Mixtas (30-70%)</span>
                </div>
                <span class="option-info">Combinación de especies nativas y exóticas, balance entre conservación y producción</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="composition-${spaceId}" value="exoticas">
                <div class="characterization-content">
                  <i class="fas fa-leaf" style="color: #F44336;"></i>
                  <span>Exóticas (>70%)</span>
                </div>
                <span class="option-info">Más del 70% de especies exóticas, menor valor de conservación pero mayor integración productiva</span>
              </label>
            </div>
          </div>
          
          <div class="panel-section">
            <h4 class="panel-section-title">
              <i class="fas fa-tractor"></i> Integración con producción
            </h4>
            <div class="characterization-options">
              <label class="characterization-option">
                <input type="radio" name="integration-${spaceId}" value="alta">
                <div class="characterization-content">
                  <i class="fas fa-check-circle" style="color: #4CAF50;"></i>
                  <span>Alta integración</span>
                </div>
                <span class="option-info">Espacio totalmente integrado con actividades productivas, bajo impacto en producción</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="integration-${spaceId}" value="media">
                <div class="characterization-content">
                  <i class="fas fa-check-circle" style="color: #FFC107;"></i>
                  <span>Media integración</span>
                </div>
                <span class="option-info">Espacio parcialmente integrado, balance entre conservación y producción</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="integration-${spaceId}" value="baja">
                <div class="characterization-content">
                  <i class="fas fa-check-circle" style="color: #F44336;"></i>
                  <span>Baja integración</span>
                </div>
                <span class="option-info">Espacio dedicado principalmente a conservación, mayor impacto en producción</span>
              </label>
            </div>
          </div>

          <div class="panel-section">
            <h4 class="panel-section-title">
              <i class="fas fa-chart-line"></i> Estado de conservación
            </h4>
            <div class="characterization-options">
              <label class="characterization-option">
                <input type="radio" name="conservation-${spaceId}" value="bueno">
                <div class="characterization-content">
                  <i class="fas fa-tree" style="color: #4CAF50;"></i>
                  <span>Buen estado</span>
                </div>
                <span class="option-info">Estructura y composición de especies en buen estado</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="conservation-${spaceId}" value="regular">
                <div class="characterization-content">
                  <i class="fas fa-tree" style="color: #FFC107;"></i>
                  <span>Estado regular</span>
                </div>
                <span class="option-info">Alteración moderada de la estructura y composición</span>
              </label>
              <label class="characterization-option">
                <input type="radio" name="conservation-${spaceId}" value="degradado">
                <div class="characterization-content">
                  <i class="fas fa-tree" style="color: #F44336;"></i>
                  <span>Degradado</span>
                </div>
                <span class="option-info">Alta alteración de la estructura y composición</span>
              </label>
            </div>
          </div>
        `;
        
        container.appendChild(spaceDiv);
      });
    }

    // Guardar características de los espacios
    function saveSpaceCharacteristics() {
      selectedSpaces.forEach(spaceId => {
        spaceCharacteristics[spaceId] = {
          size: document.querySelector(`input[name="size-${spaceId}"]:checked`)?.value,
          composition: document.querySelector(`input[name="composition-${spaceId}"]:checked`)?.value,
          integration: document.querySelector(`input[name="integration-${spaceId}"]:checked`)?.value,
          conservation: document.querySelector(`input[name="conservation-${spaceId}"]:checked`)?.value
        };
      });
    }

    // Actualizar el indicador de pasos
    function updateStepIndicator() {
      // En una implementación real, aquí se actualizaría un indicador visual de los pasos
    }

    // Cambiar herramienta activa
    function setActiveTool(tool) {
      currentTool = tool;
      
      // Actualizar botones
      document.querySelectorAll('.tool-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      document.getElementById(`${tool}-tool`).classList.add('active');
      
      // Mostrar/ocultar panel de valor de conservación
      if (tool === 'conservation') {
        conservationPanel.style.display = 'flex';
        // Aplicar colores a los hotspots según su valor de conservación
        document.querySelectorAll('.hotspot').forEach(hotspot => {
          const spaceId = hotspot.dataset.id;
          const data = dataMap[spaceId];
          if (data) {
            // Hacer los círculos más grandes para mejor visibilidad
            hotspot.style.width = '32px';
            hotspot.style.height = '32px';
            
            if (data.conservacion === 'alto') {
              hotspot.style.borderColor = '#f25f5c';
              hotspot.style.backgroundColor = 'rgba(242, 95, 92, 0.3)';
              hotspot.querySelector('.hotspot-label').style.backgroundColor = '#f25f5c';
            } else if (data.conservacion === 'medio') {
              hotspot.style.borderColor = '#f0a202';
              hotspot.style.backgroundColor = 'rgba(240, 162, 2, 0.3)';
              hotspot.querySelector('.hotspot-label').style.backgroundColor = '#f0a202';
            } else {
              hotspot.style.borderColor = '#05668d';
              hotspot.style.backgroundColor = 'rgba(5, 102, 141, 0.3)';
              hotspot.querySelector('.hotspot-label').style.backgroundColor = '#05668d';
            }
          }
        });
      } else if (tool === 'connectivity') {
        // Mostrar estrellas de conectividad
        document.querySelectorAll('.connectivity-star').forEach(star => {
          star.style.display = 'block';
        });
      } else {
        conservationPanel.style.display = 'none';
        // Ocultar estrellas de conectividad
        document.querySelectorAll('.connectivity-star').forEach(star => {
          star.style.display = 'none';
        });
        
        // Restaurar colores originales de los hotspots y tamaño
        document.querySelectorAll('.hotspot').forEach(hotspot => {
          const isSelected = hotspot.classList.contains('selected');
          hotspot.style.width = '24px';
          hotspot.style.height = '24px';
          hotspot.style.borderColor = isSelected ? 'var(--primary)' : 'var(--accent)';
          hotspot.style.backgroundColor = isSelected ? 'rgba(2, 168, 150, 0.3)' : 'rgba(242, 162, 2, 0.3)';
          hotspot.querySelector('.hotspot-label').style.backgroundColor = 'var(--white)';
        });
      }
    }

    // Manejar clic en un hotspot según la herramienta activa
    function handleHotspotClick(spaceId) {
      if (currentTool === 'select') {
        toggleSpaceSelection(spaceId);
      } else if (currentTool === 'info') {
        showSpaceInfo(spaceId);
      } else if (currentTool === 'conservation') {
        // Mostrar información sobre el valor de conservación
        const data = dataMap[spaceId];
        if (data) {
          let value = '';
          if (data.conservacion === 'alto') value = 'Prioritario (alto)';
          else if (data.conservacion === 'medio') value = 'Importante (medio)';
          else value = 'Útil (bajo)';
          
          alert(`Valor de conservación para ${data.titulo}: ${value}`);
        }
      } else if (currentTool === 'benefits') {
        // Mostrar información sobre los aportes
        const data = dataMap[spaceId];
        if (data && data.aportes) {
          const hotspot = document.querySelector(`.hotspot[data-id="${spaceId}"]`);
          const rect = hotspot.getBoundingClientRect();
          showBenefitsTooltip(spaceId, rect.right, rect.top);
        }
      }
    }

    // Mostrar popup de conectividad
    function showConnectivityPopup(starId) {
      document.getElementById(`connectivity-popup-${starId}`).classList.add('active');
    }

    // Ocultar popup de conectividad
    function hideConnectivityPopup(starId) {
      document.getElementById(`connectivity-popup-${starId}`).classList.remove('active');
    }

    // Función para manejar el arrastre del panel seleccionado
    function startDragPanel(e) {
      isDragging = true;
      e.target.style.cursor = 'grabbing';
      
      if (e.type === 'mousedown') {
        dragStartX = e.clientX - e.target.getBoundingClientRect().left;
        dragStartY = e.clientY - e.target.getBoundingClientRect().top;
      } else if (e.type === 'touchstart') {
        dragStartX = e.touches[0].clientX - e.target.getBoundingClientRect().left;
        dragStartY = e.touches[0].clientY - e.target.getBoundingClientRect().top;
      }
      
      e.preventDefault();
    }

    function dragPanel(e) {
      if (!isDragging) return;
      
      let clientX, clientY;
      if (e.type === 'mousemove') {
        clientX = e.clientX;
        clientY = e.clientY;
      } else if (e.type === 'touchmove') {
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
      }
      
      const panel = document.querySelector('.legend.dragging, .selected-panel.dragging, .conservation-value.dragging');
      if (panel) {
        panel.style.left = `${clientX - dragStartX}px`;
        panel.style.top = `${clientY - dragStartY}px`;
      }
    }

    function endDragPanel() {
      isDragging = false;
      document.querySelectorAll('.legend, .selected-panel, .conservation-value').forEach(panel => {
        panel.style.cursor = 'move';
        panel.classList.remove('dragging');
      });
    }

    // Función para manejar el arrastre del video
    function startDragVideo(e) {
      if (zoomLevel <= 1) return;
      
      isDraggingVideo = true;
      videoContainer.style.cursor = 'grabbing';
      
      if (e.type === 'mousedown') {
        videoDragStartX = e.clientX;
        videoDragStartY = e.clientY;
      } else if (e.type === 'touchstart') {
        videoDragStartX = e.touches[0].clientX;
        videoDragStartY = e.touches[0].clientY;
      }
      
      e.preventDefault();
    }

    function dragVideo(e) {
      if (!isDraggingVideo || zoomLevel <= 1) return;
      
      let clientX, clientY;
      if (e.type === 'mousemove') {
        clientX = e.clientX;
        clientY = e.clientY;
      } else if (e.type === 'touchmove') {
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
      }
      
      const dx = clientX - videoDragStartX;
      const dy = clientY - videoDragStartY;
      
      videoOffsetX += dx / zoomLevel;
      videoOffsetY += dy / zoomLevel;
      
      videoDragStartX = clientX;
      videoDragStartY = clientY;
      
      applyZoom();
    }

    function endDragVideo() {
      isDraggingVideo = false;
      videoContainer.style.cursor = 'default';
    }

    // Aplicar zoom al video
    function applyZoom() {
      video.style.transform = `scale(${zoomLevel}) translate(${videoOffsetX}px, ${videoOffsetY}px)`;
    }

    // Mostrar gráficos de comparación
    function showGraphs() {
      if (!comparisonCompleted) {
        alert('Primero debes completar el proceso de comparación para ver los gráficos.');
        return;
      }
      
      document.getElementById('graphs-panel').classList.add('active');
      
      // Generar contenido de gráficos basado en la comparación
      const graphsContent = document.getElementById('graphs-content');
      graphsContent.innerHTML = `
        <div class="panel-section">
          <h4 class="panel-section-title">
            <i class="fas fa-exclamation-triangle"></i> Nivel de atención requerido
          </h4>
          <p>Análisis comparativo de los espacios seleccionados según diferentes criterios:</p>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Biodiversidad</span>
              <span>Moderado</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 40%; background: linear-gradient(90deg, #f0a202, #f1c453);"></div>
            </div>
          </div>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Conectividad</span>
              <span>Alto</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 70%; background: linear-gradient(90deg, #f25f5c, #f48c8a);"></div>
            </div>
          </div>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Especies exóticas</span>
              <span>Bajo</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 20%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
            </div>
          </div>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Integración productiva</span>
              <span>Moderado</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 50%; background: linear-gradient(90deg, #f0a202, #f1c453);"></div>
            </div>
          </div>
        </div>
        
        <div class="panel-section">
          <h4 class="panel-section-title">
            <i class="fas fa-project-diagram"></i> Consideraciones sobre corredores
          </h4>
          <p>Los corredores biológicos son esenciales para conectar los diferentes espacios de conservación:</p>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Conectividad funcional</span>
              <span>65%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 65%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
            </div>
          </div>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Ancho efectivo</span>
              <span>40%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 40%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
            </div>
          </div>
          
          <p>Según el informe INTA, los corredores deben tener al menos 30 metros de ancho para ser efectivos para la mayoría de las especies.</p>
        </div>
        
        <div class="panel-section">
          <h4 class="panel-section-title">
            <i class="fas fa-biohazard"></i> Amenaza de especies exóticas
          </h4>
          <p>Evaluación del riesgo potencial de especies exóticas invasoras en los espacios seleccionados:</p>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Presencia actual</span>
              <span>15%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 15%; background: linear-gradient(90deg, #00a896, #02c39a);"></div>
            </div>
          </div>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Potencial de invasión</span>
              <span>30%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 30%; background: linear-gradient(90deg, #f0a202, #f1c453);"></div>
            </div>
          </div>
          
          <p>Las áreas ribereñas y los bordes de cultivo son los más susceptibles a la invasión de especies exóticas.</p>
        </div>
        
        <div class="panel-section">
          <h4 class="panel-section-title">
            <i class="fas fa-calendar-alt"></i> Cronograma sugerido
          </h4>
          <p>Recomendaciones temporales para la implementación y manejo:</p>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Invierno (Planificación)</span>
              <span>100%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 100%; background: linear-gradient(90deg, #05668d, #028090);"></div>
            </div>
          </div>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Primavera (Implementación)</span>
              <span>25%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 25%; background: linear-gradient(90deg, #05668d, #028090);"></div>
            </div>
          </div>
          
          <div class="progress-container">
            <div class="progress-label">
              <span>Verano (Monitoreo)</span>
              <span>10%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 10%; background: linear-gradient(90deg, #05668d, #028090);"></div>
            </div>
          </div>
          
          <p>La primavera es el mejor momento para la plantación y establecimiento de nuevos espacios de conservación.</p>
        </div>
      `;
    }

    // Reiniciar toda la infografía
    function resetInfographic() {
      // Detener y reiniciar el video
      video.pause();
      video.currentTime = 0;
      
      // Ocultar hotspots
      hideHotspots();
      
      // Limpiar selecciones
      selectedSpaces = [];
      document.querySelectorAll('.hotspot').forEach(hotspot => {
        hotspot.classList.remove('selected');
      });
      updateSelectedSpacesList();
      
      // Limpiar características
      spaceCharacteristics = {};
      
      // Reiniciar herramientas
      setActiveTool('select');
      
      // Ocultar paneles
      document.getElementById('info-panel').classList.remove('active');
      document.getElementById('comparison-panel').classList.remove('active');
      document.getElementById('graphs-panel').classList.remove('active');
      
      // Reiniciar pasos de comparación
      currentStep = 1;
      document.getElementById('comparison-steps').style.display = 'block';
      document.getElementById('final-report').style.display = 'none';
      showStep(currentStep);
      
      // Reproducir video de nuevo
      video.play();
    }

    // Mostrar informe INTA en modal
    function showIntaReport() {
      document.getElementById('inta-report-modal').classList.add('active');
    }

    // Ocultar informe INTA
    function hideIntaReport() {
      document.getElementById('inta-report-modal').classList.remove('active');
    }

    // Generar recomendaciones basadas en el informe INTA
    function generateIntaRecommendations() {
      const recommendationsContainer = document.getElementById('inta-recommendations');
      recommendationsContainer.innerHTML = '';
      
      let recommendations = [];
      
      // Recomendaciones generales del informe INTA
      recommendations.push(`<p><strong>Recomendaciones generales del informe INTA:</strong></p><ul>
        <li>Mantener al menos un 10% de la superficie del establecimiento como áreas de conservación</li>
        <li>Priorizar la conectividad entre espacios mediante corredores lineales</li>
        <li>Integrar espacios seminaturales con la producción para maximizar beneficios</li>
        <li>Monitorear regularmente el estado de conservación de los espacios</li>
      </ul>`);
      
      // Recomendaciones específicas basadas en los espacios seleccionados
      if (selectedSpaces.some(s => ['parque', 'area-natural', 'bosque-nativo'].includes(s))) {
        recommendations.push(`<p><strong>Áreas naturales:</strong> Según el informe INTA, estas áreas son clave para conservar biodiversidad. Recomienda:</p><ul>
          <li>Proteger de perturbaciones humanas y ganaderas</li>
          <li>Mantener una zona buffer alrededor</li>
          <li>Conectar con otros espacios mediante corredores</li>
        </ul>`);
      }
      
      if (selectedSpaces.some(s => ['franja', 'bordes', 'camino'].includes(s))) {
        recommendations.push(`<p><strong>Corredores lineales:</strong> El informe INTA destaca que:</p><ul>
          <li>Los corredores deben tener al menos 30m de ancho para ser efectivos</li>
          <li>Deben conectar al menos dos áreas núcleo</li>
          <li>La vegetación nativa aumenta su efectividad</li>
        </ul>`);
      }
      
      if (selectedSpaces.some(s => ['cortinas', 'cercos'].includes(s))) {
        recommendations.push(`<p><strong>Estructuras lineales:</strong> Según el informe:</p><ul>
          <li>Pueden mejorarse incorporando especies nativas</li>
          <li>Son importantes para movimiento de insectos y aves</li>
          <li>Deben complementarse con otros espacios</li>
        </ul>`);
      }
      
      recommendationsContainer.innerHTML = recommendations.join('');
    }

    // Inicialización
    document.addEventListener('DOMContentLoaded', () => {
      // Configurar video
      initVideo();
      
      // Configurar controles de video
      document.getElementById('play-pause-btn').addEventListener('click', function() {
        if (videoPlaying) {
          video.pause();
        } else {
          video.play();
        }
      });
      
      document.getElementById('reset-video-btn').addEventListener('click', resetInfographic);
      
      document.getElementById('skip-to-end-btn').addEventListener('click', function() {
        video.currentTime = video.duration - 0.1;
        video.pause();
        showHotspots();
      });
      
      // Configurar herramientas
      document.getElementById('select-tool').addEventListener('click', () => setActiveTool('select'));
      document.getElementById('info-tool').addEventListener('click', () => setActiveTool('info'));
      document.getElementById('conservation-tool').addEventListener('click', () => setActiveTool('conservation'));
      document.getElementById('benefits-tool').addEventListener('click', () => setActiveTool('benefits'));
      document.getElementById('connectivity-tool').addEventListener('click', () => setActiveTool('connectivity'));
      
      // Configurar hotspots
      document.querySelectorAll('.hotspot').forEach(hotspot => {
        hotspot.addEventListener('mouseenter', function(e) {
          clearTimeout(hoverTimeout);
          
          const spaceId = this.dataset.id;
          const rect = this.getBoundingClientRect();
          
          if (currentTool === 'info') {
            showTooltip(spaceId, rect.right, rect.top);
          } else if (currentTool === 'benefits') {
            showBenefitsTooltip(spaceId, rect.right, rect.top);
          } else {
            hoverTimeout = setTimeout(() => {
              if (currentTool === 'info') {
                showSpaceInfo(spaceId);
              }
            }, 1000);
          }
        });
        
        hotspot.addEventListener('mouseleave', function() {
          clearTimeout(hoverTimeout);
          hideTooltip();
        });
        
        hotspot.addEventListener('click', function(e) {
          e.stopPropagation();
          clearTimeout(hoverTimeout);
          const spaceId = this.dataset.id;
          handleHotspotClick(spaceId);
        });
      });
      
      // Configurar estrellas de conectividad
      document.querySelectorAll('.connectivity-star').forEach(star => {
        star.addEventListener('click', function(e) {
          e.stopPropagation();
          const starId = this.dataset.id;
          showConnectivityPopup(starId);
        });
      });
      
      // Configurar cierre de popups de conectividad
      document.querySelectorAll('.connectivity-popup-close').forEach(btn => {
        btn.addEventListener('click', function() {
          const popup = this.closest('.connectivity-popup');
          const starId = popup.id.split('-')[2];
          hideConnectivityPopup(starId);
        });
      });
      
      // Configurar botones de overlay
      document.getElementById('toggle-corredor-continuo').addEventListener('click', function() {
        this.classList.toggle('active');
        document.getElementById('corredor-continuo-overlay').classList.toggle('active');
      });
      
      document.getElementById('toggle-corredor-trampolin').addEventListener('click', function() {
        this.classList.toggle('active');
        document.getElementById('corredor-trampolin-overlay').classList.toggle('active');
      });
      
      document.getElementById('toggle-limites').addEventListener('click', function() {
        this.classList.toggle('active');
        document.getElementById('limites-overlay').classList.toggle('active');
      });
      
      document.getElementById('toggle-estructuras-clave').addEventListener('click', function() {
        this.classList.toggle('active');
        document.getElementById('estructuras-clave-overlay').classList.toggle('active');
      });
      
      // Configurar botón para mostrar informe final
      document.getElementById('show-comparison').addEventListener('click', generateComparison);
      
      // Configurar botón para mostrar gráficos
      document.getElementById('show-graphs').addEventListener('click', showGraphs);
      
      // Configurar botón para abrir informe INTA
      document.getElementById('show-inta-report').addEventListener('click', showIntaReport);
      document.getElementById('close-inta-report').addEventListener('click', hideIntaReport);
      
      // Configurar navegación de pasos
      document.getElementById('next-step-1').addEventListener('click', function() {
        currentStep = 2;
        showStep(currentStep);
      });
      
      document.getElementById('prev-step-2').addEventListener('click', function() {
        currentStep = 1;
        showStep(currentStep);
      });
      
      document.getElementById('next-step-2').addEventListener('click', function() {
        // Validar que se hayan seleccionado objetivos
        const selectedObjectives = document.querySelectorAll('input[name="objectives"]:checked');
        if (selectedObjectives.length === 0) {
          document.getElementById('objectives-warning').style.display = 'block';
          return;
        }
        document.getElementById('objectives-warning').style.display = 'none';
        currentStep = 3;
        showStep(currentStep);
      });
      
      document.getElementById('prev-step-3').addEventListener('click', function() {
        currentStep = 2;
        showStep(currentStep);
      });
      
      document.getElementById('next-step-3').addEventListener('click', function() {
        // Validar que se hayan seleccionado opciones para todos los espacios
        let allComplete = true;
        
        selectedSpaces.forEach(spaceId => {
          const sizeSelected = document.querySelector(`input[name="size-${spaceId}"]:checked`);
          const compositionSelected = document.querySelector(`input[name="composition-${spaceId}"]:checked`);
          const integrationSelected = document.querySelector(`input[name="integration-${spaceId}"]:checked`);
          const conservationSelected = document.querySelector(`input[name="conservation-${spaceId}"]:checked`);
          
          if (!sizeSelected || !compositionSelected || !integrationSelected || !conservationSelected) {
            allComplete = false;
          }
        });
        
        if (!allComplete) {
          alert('Debes completar todas las caracterizaciones para continuar');
          return;
        }
        
        // Guardar características
        saveSpaceCharacteristics();
        
        currentStep = 4;
        showStep(currentStep);
      });
      
      document.getElementById('prev-step-4').addEventListener('click', function() {
        currentStep = 3;
        showStep(currentStep);
      });
      
      document.getElementById('next-step-4').addEventListener('click', function() {
        currentStep = 5;
        showStep(currentStep);
      });
      
      document.getElementById('prev-step-5').addEventListener('click', function() {
        currentStep = 4;
        showStep(currentStep);
      });
      
      document.getElementById('next-step-5').addEventListener('click', function() {
        currentStep = 6;
        showStep(currentStep);
      });
      
      document.getElementById('prev-step-6').addEventListener('click', function() {
        currentStep = 5;
        showStep(currentStep);
      });
      
      document.getElementById('finish-process').addEventListener('click', function() {
        document.getElementById('comparison-steps').style.display = 'none';
        document.getElementById('final-report').style.display = 'block';
        comparisonCompleted = true;
        
        // Generar resumen de espacios seleccionados
        const summary = document.getElementById('selected-spaces-summary');
        summary.innerHTML = '';
        
        selectedSpaces.forEach(spaceId => {
          const data = dataMap[spaceId];
          if (!data) return;
          
          const spaceDiv = document.createElement('div');
          spaceDiv.className = 'panel-section';
          spaceDiv.innerHTML = `
            <h4>${data.titulo}</h4>
            <p><strong>Categoría:</strong> ${data.categoria}</p>
            <p>${data.texto}</p>
            <p><strong>Características registradas:</strong></p>
            <ul>
              <li>Tamaño: ${spaceCharacteristics[spaceId]?.size || 'No especificado'}</li>
              <li>Composición: ${spaceCharacteristics[spaceId]?.composition || 'No especificado'}</li>
              <li>Integración: ${spaceCharacteristics[spaceId]?.integration || 'No especificado'}</li>
              <li>Estado: ${spaceCharacteristics[spaceId]?.conservation || 'No especificado'}</li>
            </ul>
            <p><strong>Beneficios clave:</strong></p>
            <ul>
              ${data.beneficiosProduccion.map(b => `<li>${b}</li>`).join('')}
            </ul>
          `;
          summary.appendChild(spaceDiv);
        });
        
        // Generar recomendaciones basadas en el informe INTA
        generateIntaRecommendations();
      });
      
      // Configurar paneles
      document.getElementById('close-panel').addEventListener('click', hideSpaceInfo);
      document.getElementById('close-comparison').addEventListener('click', function() {
        document.getElementById('comparison-panel').classList.remove('active');
        document.getElementById('comparison-steps').style.display = 'block';
        document.getElementById('final-report').style.display = 'none';
        currentStep = 1;
        showStep(currentStep);
      });
      
      document.getElementById('close-graphs').addEventListener('click', function() {
        document.getElementById('graphs-panel').classList.remove('active');
      });
      
      // Configurar arrastre de paneles
      [selectedPanel, legendPanel, conservationPanel].forEach(panel => {
        panel.addEventListener('mousedown', function(e) {
          if (e.target === this || e.target.classList.contains('legend-title') || e.target.classList.contains('selected-title')) {
            this.classList.add('dragging');
            startDragPanel(e);
          }
        });
      });
      
      document.addEventListener('mousemove', function(e) {
        dragPanel(e);
        dragVideo(e);
      });
      
      document.addEventListener('mouseup', function() {
        endDragPanel();
        endDragVideo();
      });
      
      // Configurar arrastre del video
      videoContainer.addEventListener('mousedown', startDragVideo);
      
      // Establecer herramienta por defecto
      setActiveTool('select');
      
      // Configurar zoom en imágenes de pasos
      document.querySelectorAll('.step-image').forEach(img => {
        img.addEventListener('click', function() {
          this.classList.toggle('zoomed');
        });
      });
      
      // Configurar botón de descarga de informe
      document.getElementById('generate-report-btn').addEventListener('click', function() {
        // Crear contenido del informe en formato Word
        let reportContent = `
          <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
          <head>
            <title>Informe de Espacios de Conservación</title>
            <style>
              body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }
              h1 { color: #028090; }
              h2 { color: #05668d; margin-top: 20px; }
              .space { margin-bottom: 30px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
              .progress-container { margin-bottom: 15px; }
              .progress-bar { height: 10px; background: #edf2f4; border-radius: 5px; overflow: hidden; }
              .progress-fill { height: 100%; border-radius: 5px; }
              .benefit-item { margin-bottom: 10px; display: flex; align-items: center; }
              .benefit-icon { margin-right: 10px; }
            </style>
          </head>
          <body>
            <h1>Informe de Espacios de Conservación</h1>
            <p>Fecha: ${new Date().toLocaleDateString()}</p>
            
            <h2>Espacios seleccionados</h2>
        `;
        
        // Agregar información de cada espacio seleccionado
        selectedSpaces.forEach(spaceId => {
          const data = dataMap[spaceId];
          if (!data) return;
          
          reportContent += `
            <div class="space">
              <h3>${data.titulo}</h3>
              <p><strong>Categoría:</strong> ${data.categoria}</p>
              <p>${data.texto}</p>
              
              <h4>Características registradas</h4>
              <ul>
                <li>Tamaño: ${spaceCharacteristics[spaceId]?.size || 'No especificado'}</li>
                <li>Composición: ${spaceCharacteristics[spaceId]?.composition || 'No especificado'}</li>
                <li>Integración: ${spaceCharacteristics[spaceId]?.integration || 'No especificado'}</li>
                <li>Estado: ${spaceCharacteristics[spaceId]?.conservation || 'No especificado'}</li>
              </ul>
              
              <h4>Beneficios para la producción</h4>
              <ul>
                ${data.beneficiosProduccion.map(item => `<li>${item}</li>`).join('')}
              </ul>
              
              <h4>Beneficios para la biodiversidad</h4>
              <ul>
                ${data.beneficiosNaturaleza.map(item => `<li>${item}</li>`).join('')}
              </ul>
              
              <h4>Principales aportes</h4>
              ${Object.entries(data.aportes).map(([code, description]) => `
                <div class="benefit-item">
                  <span class="benefit-icon">${code}</span>
                  <span>${description}</span>
                </div>
              `).join('')}
            </div>
          `;
        });
        
        // Agregar análisis comparativo basado en el informe INTA
        reportContent += `
          <h2>Análisis Comparativo según informe INTA</h2>
          
          <h3>Recomendaciones clave</h3>
          <p>Basado en el documento "Espacios de Conservación de Agroecosistemas" del INTA:</p>
          <ul>
            <li>Los corredores biológicos deben tener al menos 30 metros de ancho para ser efectivos</li>
            <li>Las áreas naturales mayores a 5 hectáreas son clave para conservar biodiversidad</li>
            <li>Los bordes de cultivo mejoran la polinización y control biológico de plagas</li>
            <li>La integración de espacios seminaturales puede aumentar la productividad en un 15-20%</li>
          </ul>
          
          <h3>Recomendaciones específicas para tu selección</h3>
          <p>Basado en los espacios que has seleccionado, estas son las recomendaciones clave del informe INTA:</p>
          <ul>
            <li>Priorizar la conectividad entre espacios mediante corredores lineales</li>
            <li>Mantener al menos un 10% de la superficie del establecimiento como área de conservación</li>
            <li>Integrar espacios seminaturales con la producción para maximizar beneficios</li>
            <li>Monitorear regularmente el estado de conservación de los espacios</li>
          </ul>
          
          <h3>Impacto potencial en tu campo</h3>
          <p>Según la selección realizada, puedes esperar:</p>
          <ul>
            <li>Mejora en la polinización de cultivos</li>
            <li>Reducción en la necesidad de control químico de plagas</li>
            <li>Mayor retención de agua y reducción de erosión</li>
            <li>Incremento en la biodiversidad funcional</li>
          </ul>
          
          <p style="margin-top: 30px; font-size: 0.9em; color: #666;">
            Informe generado por la plataforma INTA Conservación - ${new Date().getFullYear()}
          </p>
        </body>
        </html>
        `;
        
        // Crear blob y descargar como documento Word
        const blob = new Blob(['\ufeff', reportContent], { type: 'application/msword' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Informe_Espacios_Conservacion.doc';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      });
    });
  </script>
</body>
</html>